{"remainingRequest":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/src/pages/Playsong.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/src/pages/Playsong.vue","mtime":1589860894000},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/css-loader/dist/cjs.js","mtime":1621232596304},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1621232596899},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/postcss-loader/src/index.js","mtime":1592202187989},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/less-loader/dist/cjs.js","mtime":1620626793194},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/cache-loader/dist/cjs.js","mtime":1619416685351},{"path":"/home/lxy/Projects/UniversityExperiments/MobileAppsDev/Experiment5/vue-music/Music-play-front/node_modules/vue-loader/lib/index.js","mtime":1621232596899}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoucGxheUJveCB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgcGFkZGluZy10b3A6IDAuNHJlbTsNCg0KICAuY29udGVudCB7DQogICAgcGFkZGluZzogMCAwLjRyZW07DQogICAgLmhlYWRlciB7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICBoMiB7DQogICAgICAgIGxpbmUtaGVpZ2h0OiAwLjU2cmVtOw0KICAgICAgICBmb250LXNpemU6IDAuMzhyZW07DQogICAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgICB9DQogICAgICBwIHsNCiAgICAgICAgbGluZS1oZWlnaHQ6IDAuNDRyZW07DQogICAgICAgIGZvbnQtc2l6ZTogMC4zMnJlbTsNCiAgICAgICAgY29sb3I6IGdyZXk7DQogICAgICB9DQogICAgfQ0KDQogICAgLmx5cmljIHsNCiAgICAgIG1hcmdpbi10b3A6IDAuMnJlbTsNCiAgICAgIGhlaWdodDogNC45cmVtOw0KICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCg0KICAgICAgcCB7DQogICAgICAgIGhlaWdodDogMC42cmVtICFpbXBvcnRhbnQ7DQogICAgICAgIGxpbmUtaGVpZ2h0OiAwLjZyZW07DQogICAgICAgIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNyk7DQogICAgICAgIGZvbnQtc2l6ZTogMC4zcmVtOw0KICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsNCiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgdHJhbnNpdGlvbjogMC4yczsNCg0KICAgICAgICAmLmFjdGl2ZSB7DQogICAgICAgICAgY29sb3I6ICMyMmQ1OWM7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICAuaGFuZGxlIHsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICBoZWlnaHQ6IDEuNXJlbTsNCg0KICAgICAgaSB7DQogICAgICAgIG1hcmdpbjogMCAwLjNyZW07DQogICAgICAgIHdpZHRoOiAwLjhyZW07DQogICAgICAgIGhlaWdodDogMC44cmVtOw0KICAgICAgICBib3JkZXI6IDAuMDJyZW0gc29saWQgcmdiYSgwLCAwLCAwLCAwLjIpOw0KICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQoNCiAgICAgICAgJjpudGgtY2hpbGQoMSkgew0KICAgICAgICAgIGJhY2tncm91bmQ6IHVybCgiLi4vYXNzZXRzL2ltYWdlcy90dHBvZGljb24uc3ZnIikgbm8tcmVwZWF0IGNlbnRlcg0KICAgICAgICAgICAgY2VudGVyOw0KICAgICAgICAgIGJhY2tncm91bmQtc2l6ZTogMC42cmVtIDAuNnJlbTsNCiAgICAgICAgfQ0KDQogICAgICAgICY6bnRoLWNoaWxkKDMpIHsNCiAgICAgICAgICBiYWNrZ3JvdW5kOiB1cmwoIi4uL2Fzc2V0cy9pbWFnZXMvc2hvdWNhbmcuc3ZnIikgbm8tcmVwZWF0IDUwJSA1MiU7DQogICAgICAgICAgYmFja2dyb3VuZC1zaXplOiAwLjM1cmVtIDAuMzVyZW07DQogICAgICAgIH0NCg0KICAgICAgICAmOm50aC1jaGlsZCgyKSB7DQogICAgICAgICAgYmFja2dyb3VuZDogdXJsKCIuLi9hc3NldHMvaW1hZ2VzL2JvZmFuZy5zdmciKSBuby1yZXBlYXQgNTglIGNlbnRlcjsNCiAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDAuNDVyZW0gMC40NXJlbTsNCg0KICAgICAgICAgICYuemFudGluZyB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB1cmwoIi4uL2Fzc2V0cy9pbWFnZXMvemFudGluZy5zdmciKSBuby1yZXBlYXQgY2VudGVyDQogICAgICAgICAgICAgIGNlbnRlcjsNCiAgICAgICAgICAgIGJhY2tncm91bmQtc2l6ZTogMC40NXJlbSAwLjQ1cmVtOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC5iZyB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHRvcDogMDsNCiAgICBsZWZ0OiAwOw0KICAgIHotaW5kZXg6IC0xOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGltZyB7DQogICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgb3BhY2l0eTogMC4wNDsNCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Playsong.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyKA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Playsong.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n  <div class=\"playBox\" v-if=\"songDATA\">\r\n    <div class=\"bg\">\r\n      <img :src=\"songDATA.pic\" alt />\r\n    </div>\r\n\r\n    <div class=\"content\">\r\n      <div class=\"header\">\r\n        <h2 v-text=\"songDATA.title\"></h2>\r\n        <p v-text=\"songDATA.author\"></p>\r\n      </div>\r\n      <div class=\"lyric swiper-container\" ref=\"lyric\">\r\n        <div class=\"wrapper swiper-wrapper\">\r\n          <p\r\n            v-for=\"(item,index) in songDATA.lyric\"\r\n            v-text=\"item.content\"\r\n            :key=\"index\"\r\n            :class=\"`swiper-slide ${lyricIndex===index?'active':''}`\"\r\n          ></p>\r\n        </div>\r\n      </div>\r\n      <div class=\"handle\">\r\n        <i @click=\"openVideo(songDATA.id)\"></i>\r\n        <i ref=\"audioBtn\"></i>\r\n        <i></i>\r\n      </div>\r\n    </div>\r\n\r\n    <audio :src=\"songDATA.music\" style=\"display:none\" ref=\"audio\"></audio>\r\n\r\n    <!-- 热门推荐 -->\r\n    <recommend></recommend>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Swiper from \"swiper\";   //是目前应用较广泛的移动端网页触摸内容滑动js插件,https://www.swiper.com.cn/\r\nimport Recommend from \"../components/Recommend.vue\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      lyricIndex: 0\r\n    };\r\n  },\r\n  components: {\r\n    Recommend\r\n  },\r\n  computed: {\r\n    songDATA() {\r\n      const { cur, list } = this.$store.state;\r\n      return (\r\n        list.find(item => {\r\n          return parseInt(item.id) === cur;\r\n        }) || null\r\n      );\r\n    }\r\n  },\r\n  created() {\r\n    this.$store.dispatch(\"queryDataA\", this.$route.params.id);\r\n  },\r\n  watch: {\r\n    $route(to) {\r\n      this.audioComplete();\r\n      this.$store.dispatch(\"queryDataA\", to.params.id);\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initSwiper();\r\n    this.audioHandle();\r\n  },\r\n  updated() {\r\n    this.initSwiper();\r\n    this.audioHandle();\r\n  },\r\n  methods: {\r\n    // 初始化SWIPER\r\n    initSwiper() {\r\n      if (!this.songDATA) return;\r\n      if (this.$swiper) {\r\n        this.$swiper.updateSlides();\r\n        this.$swiper.updateSize();\r\n        return;\r\n      }\r\n      this.$swiper = new Swiper(this.$refs.lyric, {\r\n        direction: \"vertical\",\r\n        slidesPerView: \"auto\"\r\n      });\r\n    },\r\n    // 跳转到MV\r\n    openVideo(id) {\r\n      this.$router.push(`/playvideo/${id}`);\r\n    },\r\n    // 控制音乐的播放和暂停\r\n    audioPlay() {\r\n      let { audio, audioBtn } = this.$refs;\r\n      if (!audio) return;\r\n      audio.play();\r\n      audioBtn.className = \"zanting\";\r\n      this.lyricAuto();\r\n    },\r\n    audioPause() {\r\n      let { audio, audioBtn } = this.$refs;\r\n      if (!audio) return;\r\n      audio.pause();\r\n      audioBtn.className = \"\";\r\n      window.clearInterval(this.lyricTimer);\r\n    },\r\n    audioComplete() {\r\n      window.clearInterval(this.lyricTimer);\r\n      this.lyricIndex = 0;\r\n      this.$swiper.slideTo(0, 0);\r\n    },\r\n    audioHandle() {\r\n      // 控制音乐的自动播放\r\n      let play = () => {\r\n        this.audioPlay();\r\n        document.removeEventListener(\"touchstart\", play);\r\n      };\r\n      play();\r\n      document.addEventListener(\"WeixinJSBridgeReady\", play);\r\n      document.addEventListener(\"touchstart\", play);\r\n\r\n      // 点击按钮控制暂停或者继续播放\r\n      let { audio, audioBtn } = this.$refs;\r\n      if (!audio) return;\r\n      audioBtn.onclick = () => {\r\n        if (audio.paused) {\r\n          this.audioPlay();\r\n          return;\r\n        }\r\n        this.audioPause();\r\n      };\r\n    },\r\n    lyricAuto() {\r\n      let { audio } = this.$refs;\r\n      if (!audio) return;\r\n      window.clearInterval(this.lyricTimer);\r\n      this.lyricTimer = window.setInterval(() => {\r\n        let duration = audio.duration,\r\n          currentTime = audio.currentTime;\r\n        if (currentTime >= duration) {\r\n          this.audioComplete();\r\n          return;\r\n        }\r\n        // 歌词对应和跟着动\r\n        if (!this.songDATA) return;\r\n        let n;\r\n        this.songDATA.lyric.find((item, index) => {\r\n          let { minutes, seconds } = item;\r\n          if (minutes * 60 + parseInt(seconds) === Math.round(currentTime)) {\r\n            n = index;\r\n            return true;\r\n          }\r\n          return false;\r\n        });\r\n        if (n && n !== this.lyricIndex) {\r\n          this.lyricIndex = n;\r\n          let index = this.lyricIndex - 3;\r\n          index < 0 ? (index = 0) : null;\r\n          this.$swiper.slideTo(index, 200);\r\n        }\r\n      }, 1000);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.playBox {\r\n  position: relative;\r\n  padding-top: 0.4rem;\r\n\r\n  .content {\r\n    padding: 0 0.4rem;\r\n    .header {\r\n      text-align: center;\r\n      h2 {\r\n        line-height: 0.56rem;\r\n        font-size: 0.38rem;\r\n        font-weight: normal;\r\n      }\r\n      p {\r\n        line-height: 0.44rem;\r\n        font-size: 0.32rem;\r\n        color: grey;\r\n      }\r\n    }\r\n\r\n    .lyric {\r\n      margin-top: 0.2rem;\r\n      height: 4.9rem;\r\n      text-align: center;\r\n      overflow: hidden;\r\n\r\n      p {\r\n        height: 0.6rem !important;\r\n        line-height: 0.6rem;\r\n        color: rgba(0, 0, 0, 0.7);\r\n        font-size: 0.3rem;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        transition: 0.2s;\r\n\r\n        &.active {\r\n          color: #22d59c;\r\n        }\r\n      }\r\n    }\r\n\r\n    .handle {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      height: 1.5rem;\r\n\r\n      i {\r\n        margin: 0 0.3rem;\r\n        width: 0.8rem;\r\n        height: 0.8rem;\r\n        border: 0.02rem solid rgba(0, 0, 0, 0.2);\r\n        border-radius: 50%;\r\n\r\n        &:nth-child(1) {\r\n          background: url(\"../assets/images/ttpodicon.svg\") no-repeat center\r\n            center;\r\n          background-size: 0.6rem 0.6rem;\r\n        }\r\n\r\n        &:nth-child(3) {\r\n          background: url(\"../assets/images/shoucang.svg\") no-repeat 50% 52%;\r\n          background-size: 0.35rem 0.35rem;\r\n        }\r\n\r\n        &:nth-child(2) {\r\n          background: url(\"../assets/images/bofang.svg\") no-repeat 58% center;\r\n          background-size: 0.45rem 0.45rem;\r\n\r\n          &.zanting {\r\n            background: url(\"../assets/images/zanting.svg\") no-repeat center\r\n              center;\r\n            background-size: 0.45rem 0.45rem;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .bg {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: -1;\r\n    width: 100%;\r\n    img {\r\n      display: block;\r\n      width: 100%;\r\n      opacity: 0.04;\r\n    }\r\n  }\r\n}\r\n</style>"]}]}